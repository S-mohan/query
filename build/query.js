/*!
 * query 1.0.0
 * (c) 2018 Smohan<https://smohan.net>
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Query",[],t):"object"==typeof exports?exports.Query=t():e.Query=t()}(this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=Object.prototype.toString,o=[!0,1,"1","true"],u=[!1,0,"0","false"],s=["string","number","boolean","symbol"],f=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,c=function(e){return"[object RegExp]"===i.call(e)},a=function(e){return"string"==typeof e},l=function(e){return void 0===e},p=function(e){return null===e},y=function(e){return"number"==typeof e},b=function(e){return y(e)&&e%1==0},d=function(e){return a(e)&&(e=e.toLowerCase()),!!~o.indexOf(e)},h=function(e){return a(e)&&(e=e.toLowerCase()),!!~u.indexOf(e)},m={regex:function(e,t){if(!c(e))throw TypeError("[VALIDATE ERROR]: The parameter reg must be a RegExp object");return!!e.test(t)},isRegexp:c,isString:a,isUndefined:l,isNull:p,isEmpty:function(e){return!!(l(e)||p(e)||a(e)&&0===e.trim().length)},isObject:function(e){return!p(e)&&"object"===(void 0===e?"undefined":r(e))},isPlainObject:function(e){return"[object Object]"===i.call(e)},isArray:function(e){return Array.isArray.call(null,e)},isPrimitive:function(e){return!!~s.indexOf(void 0===e?"undefined":r(e))},isFunction:function(e){return"function"==typeof e},isNumber:y,isInteger:b,isFloat:function(e){return+e&&e!==(0|e)},isSafeInteger:function(e){return b(e)&&e>=-f&&e<=f},isTrue:d,isFalse:h,isBoolean:function(e){return d(e)||h(e)}},g=(Object.prototype.hasOwnProperty,function(e){return JSON.parse(JSON.stringify(e))}),O=["eq","neq","gt","gte","lt","lte","like","in","nin","exists"],v=["and","or"];function x(e,t){if(!(this instanceof x))return new x(e);Array.isArray(e),this.source=e,this.target=g(e),this.size=e.length,this.params=Object.create(null),this.params.query=[]}x.version="1.0.0";var j=x.prototype;function S(e,t,n){var r=!0;switch(t){case"like":case"in":case"nin":break;case"neq":r=e!==n;break;case"lt":r=e<n;break;case"lte":r=e<=n;break;case"gt":r=e>n;break;case"gte":r=e>=n;break;case"eq":default:r=e===n}return r}function _(e,t){if(!m.isEmpty(e)){for(var n=e.split(".");n.length;){if(t=t[n.shift()],!m.isPlainObject(t)&&!m.isArray(t))break}return t}}j.skip=function(e){return this.params.skip=e||0,this},j.limit=function(e){return this.params.limit=e||0,this},j.where=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"eq",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"and";if(!m.isString(e)||m.isEmpty(e))return this;if(null!==t&&void 0!==t&&!m.isPrimitive(t))throw new TypeError("Query: 参数condition必须是一个基本类型值");n=n.toLocaleLowerCase(),n=~O.indexOf(n)?n:"eq",r=r.toLocaleLowerCase();var i={_f:e,_c:t,_e:n,_r:r=~v.indexOf(r)?r:"and"};return~JSON.stringify(this.params.query).indexOf(JSON.stringify(i))||this.params.query.push(i),this},j.count=function(){},j.find=function(){var e=this.params,t=this.target,n=(this.size,e.query),r=[];t.forEach(function(e){(function(e,t){if(0===t.length)return!0;for(var n=!0,r=0,i=t.length;r<i;r++){var o=t[r],u=o._f,s=o._c,f=o._e,c=o._r,a=_(u,e),l=S(a,f,s);n="or"===c?n||l:n&&l}return n})(e,n)&&r.push(e)}),console.log(r)};t.default=x}]).default});